/*
 * This file was generated by the Gradle 'init' task.
 *
 * This generated file contains a sample Java library project to get you started.
 * For more details take a look at the 'Building Java & JVM projects' chapter in the Gradle
 * User Manual available at https://docs.gradle.org/6.8/userguide/building_java_projects.html
 */

plugins {
    // Apply the java-library plugin for API and implementation separation.
    id 'java-library'
    id 'org.flywaydb.flyway' version '7.5.4' // Flyway 플러그인 추가
}

repositories {
    // Use Maven Central for resolving dependencies.
    //mavenCentral()

    // Local repository for JAR files
    flatDir {
        dirs 'libs' // 'libs' 디렉토리를 로컬 리포지토리로 설정
    }
}

dependencies {

    // SLF4J with Logback
    implementation name: 'slf4j-api-1.7.30'
    implementation name: 'logback-core-1.2.3' // Logback Core 추가
    implementation name: 'logback-classic-1.2.3'

    // JUnit 4 and Mockito for testing
    testImplementation name: 'junit-4.13.2'
    testImplementation name: 'hamcrest-core-1.3'
    testImplementation name: 'mockito-core-3.9.0'
    testImplementation name: 'byte-buddy-1.10.22'
    testImplementation name: 'byte-buddy-agent-1.10.22'
    testImplementation name: 'objenesis-2.6'

    // Commons Math library
    api name: 'commons-math3-3.6.1'

    // PostgreSQL JDBC Driver
    implementation name: 'postgresql-42.2.20'

    // MyBatis for ORM (Object-Relational Mapping)
    implementation name: 'mybatis-3.5.6'
    implementation name: 'mybatis-spring-boot-starter-2.1.0'

    // HikariCP for database connection pooling
    implementation name: 'HikariCP-4.0.3'

    // PDFBox and FontBox libraries from local repository
    implementation name: 'pdfbox-2.0.24'
    implementation name: 'fontbox-2.0.24'

    // Commons Logging for PDFBox
    implementation name: 'commons-logging-1.2'
    
    // Spring Core Libraries
    implementation name: 'spring-context-5.1.8.RELEASE'
    implementation name: 'spring-beans-5.1.8.RELEASE'
    implementation name: 'spring-core-5.1.8.RELEASE'
    implementation name: 'spring-aop-5.1.8.RELEASE'
    implementation name: 'spring-expression-5.1.8.RELEASE'
    
    // Spring Transaction Management (PlatformTransactionManager)
    implementation name: 'spring-tx-5.1.8.RELEASE'

    // Spring Boot and related libraries from local repository
    implementation name: 'spring-boot-2.1.6.RELEASE'
    implementation name: 'spring-boot-autoconfigure-2.1.6.RELEASE'
    implementation name: 'spring-boot-starter-2.1.6.RELEASE'
    implementation name: 'spring-boot-starter-web-2.1.6.RELEASE'
    implementation name: 'spring-web-5.1.8.RELEASE'
    implementation name: 'spring-webmvc-5.1.8.RELEASE'
    implementation name: 'spring-boot-starter-logging-2.1.6.RELEASE'
    
    // Lombok
    compileOnly name: 'lombok-1.18.20' // 컴파일 시에만 적용
    annotationProcessor name: 'lombok-1.18.20' // 애노테이션 프로세싱

    // Spring Batch
    implementation name: 'spring-batch-core-4.2.2.RELEASE'
    implementation name: 'spring-batch-infrastructure-4.2.2.RELEASE'
    implementation name: 'spring-batch-test-4.2.2.RELEASE'
    
    // Javax Batch API
    implementation name: 'javax.batch-api-1.0'
    
    // Micrometer Core
    implementation name: 'micrometer-core-1.1.0'
    
    // 로컬 리포지토리에서 Flyway
    implementation name: 'flyway-core-7.5.4'
}

flyway {
    url = 'jdbc:postgresql://localhost:5432/currency'
    user = 'postgres'
    password = 'Root1234!'
    schemas = ['public']
    locations = ['filesystem:src/main/resources/db/migration']
}

sourceCompatibility = '1.8'
targetCompatibility = '1.8'

// Set the encoding to UTF-8 for all JavaCompile tasks
tasks.withType(JavaCompile) {
    options.encoding = 'UTF-8'
    options.compilerArgs << "-Xlint:deprecation"
}

tasks.withType(Test) {
    useJUnitPlatform()
    ignoreFailures = true
}
